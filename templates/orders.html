{% extends 'base.html' %}
{% load staticfiles %}
{% block content %}
{% load natural_time %}

<section class="cart_section">
   <div class="container">
      <div class="heading_top">
         <h2>My Orders</h2>
      </div>
      <div class="table-responsive">
         <table class="table table-hover table-bordered">
            <tbody>
               <tr>
                  <th style="text-align: center;">Order Number</th>
                  <th style="text-align: center;">Product</th>
                  <th style="text-align: center;">Product Name</th>
                  <th style="text-align: center;">Quant.</th>
                  <th style="text-align: center;">Total Price</th>
                  <th style="text-align: center;">Order Date</th>
                  <th style="text-align: center;">Delivery Status</th>
                  <th></th>
               </tr>
               {% for order in orders %} 
               <tr>
                  <td style="text-align: center;">
                     <strong>#{{order.order_number|truncatechars:8}}</strong>
                  </td>
                  <td style="text-align: center;">
                     <figure class="cart_figure">
                        <img src="{{order.product.image.0}}" alt="" />
                     </figure>
                  </td>
                  <td class="text-center">
                     {{order.product.title}}
                  </td>
                  <td class="text-center" style="text-align: center;">{{order.quantity}}
                  {% if order.product.selling_price %}
                      <td class="text-center" style="text-align:center;">${{order.product.selling_price|tax:order.quantity|floatformat:2}}</td>
                  {% else %}
                      <td class="text-center" style="text-align:center;">${{order.product.price|tax:order.quantity|floatformat:2}}</td>
                  {% endif %}
                  <td class="text-center" style="text-align: center;">{{order.created_at|date:"D, d M Y"}}</td>
                  {% if order.order_id.delivery_status %}
                  <td class="text-center" style="text-align: center;">Delivered</td>
                  {% else %}
                  <td class="text-center" style="text-align: center;">Pending</td>
                  {% endif %}
                  <td class="text-center" style="text-align: center;">
                     {% if order.order_id.delivery_status %}
                     {% else %}
                     <a class="btn btn-red-custom"  href="{% url 'Juntos:cancel-order-and-refund' order.id %}" >Cancel Order</a>
                     {% endif %}
                  </td>
               </tr>
               {% endfor %}
            </tbody>
         </table>
      </div>
      <div class="pagination-in text-center">
         {% if orders %}
         {% if orders.has_other_pages %}
         <div class="bdr-bottom"></div>
         <div class="pagination-top text-center"></div>
         <ul class="pagination text-center">
            {% if orders.has_previous %}
            <li><a href="?page={{ orders.previous_page_number }}" class="paginate left" >&#xab;</a></li>
            {% else %}
            <li class="disabled"><a class="paginate left">&#xab;</a></li>
            {% endif %}
            {% for i in orders.paginator.page_range %}
            {% if orders.number == i %}
            <li class="active"><a>{{ i }}</a></li>
            {% else %}
            <li><a href="?page={{ i }}">{{ i }}</a></li>
            {% endif %}
            {% endfor %}
            {% if orders.has_next %}
            <li><a href="?page={{ orders.next_page_number }}" class="paginate right">&#xbb;</a></li>
            {% else %}
            <li class="disabled"><a class="paginate right">&#xbb;</a></li>
            {% endif %}
         </ul>
         {% endif %}
         {% else %}
         No Order Data Available !
         {% endif %}
      </div>
      <!--<div class="next-pre-cart-btn text-right">
         <a class="btn btn-red-custom" href="cancel-order.html">Cancel Order</a>
         </div>-->
   </div>
</section>
</body>
</html>
{% endblock %}